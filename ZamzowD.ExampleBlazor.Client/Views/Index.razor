@page "/"
@using ReactiveUI.Blazor
@using System.Reactive.Threading.Tasks
@using ZamzowD.ExampleBlazor.Client.ViewModels

@inherits ReactiveInjectableComponentBase<IndexViewModel>

<h1>Hello, world!</h1>

Welcome to your new app.

@if (ViewModel.Loading)
{
    <div><em>Loading...</em></div>
}
else
{
    <div>
        <button @onclick="LoadTodos">Refresh</button>
    </div>
    @foreach (var todo in ViewModel.Todos)
    {
        <div>Title: @todo.Title</div>
        <div>Completed: @todo.Completed</div>
    }
}

@code
{

    protected override Task OnInitializedAsync()
    {
        return LoadTodos();
    }

    private Task LoadTodos()
    {
        return ViewModel.LoadTodos.Execute().ToTask();
    }
}
